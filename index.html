<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dua Lipa — Radical Optimism & Live from the Royal Albert Hall (Fan Page)</title>
<link rel="icon" href="Dua_Lipa.jpg" type="image/x-icon" />
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
/* ---------- RESET & BASE ---------- */
*{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:"Inter",sans-serif;background:#070809;color:#fff;-webkit-font-smoothing:antialiased;overflow-x:hidden}
a{color:inherit;text-decoration:none}
button{cursor:pointer}

/* ---------- LAYOUT ---------- */
.container{max-width:1200px;margin:24px auto;padding:22px}
.header{display:flex;flex-direction:column;align-items:center;gap:18px;padding:28px;border-radius:14px;background:linear-gradient(180deg,rgba(10,10,12,0.95),rgba(4,4,6,0.95));box-shadow:0 12px 40px rgba(0,0,0,0.6)}
.header img{width:220px;height:220px;border-radius:14px;object-fit:cover;box-shadow:0 12px 40px rgba(0,0,0,0.6)}
.header h1{font-size:2rem}
.header p{color:#d7d7d7;line-height:1.6;max-width:980px;text-align:center}

/* ---------- ALBUM CARDS ---------- */
.albums-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px;margin:28px 0}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px;padding:0;overflow:hidden;cursor:pointer;transition:transform .18s, box-shadow .18s; box-shadow:0 8px 30px rgba(0,0,0,0.5)}
.card:hover{transform:translateY(-6px)}
.card img{width:100%;height:260px;object-fit:cover;display:block}
.card .card-body{padding:16px}
.card h3{font-size:1.05rem;margin-bottom:8px}
.card p{color:#cfcfcf;font-size:0.95rem;line-height:1.5}

/* ---------- ALBUM PAGE ---------- */
.album-page{display:none;padding:22px 0 80px}
.album-page.active{display:block;animation:fadeIn .36s ease both}
.back{display:inline-block;margin-bottom:18px;background:#ff6b6b;border:0;padding:10px 14px;border-radius:10px;color:#fff;font-weight:800;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,0.45)}

/* album header inside page */
.album-header{display:flex;gap:18px;align-items:center;margin-bottom:18px;flex-wrap:wrap}
.album-header img{width:160px;height:160px;border-radius:12px;object-fit:cover;box-shadow:0 12px 36px rgba(0,0,0,.5)}
.album-header h2{font-size:1.4rem}
.album-desc{color:#d9d9d9;max-width:900px;line-height:1.6;margin-top:6px}

/* tracklist */
.tracklist{max-width:980px;margin-top:18px;padding:16px;border-radius:12px;background:rgba(255,255,255,0.02);box-shadow:inset 0 1px 0 rgba(255,255,255,0.01)}
.track{display:flex;justify-content:space-between;align-items:center;padding:12px;border-radius:10px;margin-bottom:10px;transition:0.16s;cursor:pointer}
.track:hover{transform:translateY(-4px);background:rgba(255,255,255,0.03)}
.track .num{width:36px;text-align:center;color:#aaa;font-weight:800}
.track .title{font-weight:700;color:#fff;flex:1;padding-left:12px}
.track .duration{color:#aaa;font-weight:700}

/* ---------- MINI PLAYER (fixed bottom) ---------- */
#mini-player{position:fixed;left:12px;right:12px;bottom:12px;padding:12px;border-radius:12px;display:flex;align-items:center;justify-content:space-between;gap:12px;box-shadow:0 12px 36px rgba(0,0,0,.5);display:none;z-index:1500}
.mini-left{display:flex;align-items:center;gap:12px}
.mini-cover{width:66px;height:66px;border-radius:8px;object-fit:cover;box-shadow:0 8px 24px rgba(0,0,0,.4)}
.mini-title{font-weight:800;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:280px}
.mini-time{color:#eafafa;font-weight:700}
.mini-controls{display:flex;align-items:center;gap:8px}
.mini-controls button{width:40px;height:40px;border-radius:50%;border:0;background:transparent;color:#fff;font-size:18px;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.35)}

/* ---------- FULLSCREEN VIDEO PLAYER ---------- */
#fullscreen-player{position:fixed;inset:0;display:none;z-index:2000;background:#000;align-items:flex-end;justify-content:flex-end;overflow:hidden}
.bg-video-wrap{position:absolute;inset:0;z-index:0;overflow:hidden;background:#000}
.bg-video-wrap video{width:100%;height:100%;object-fit:cover;display:block}

/* controls panel at bottom - opaque */
#fs-controls-panel{position:relative;z-index:1600;width:100%;padding:22px;background:linear-gradient(180deg, rgba(0,0,0,0.0), rgba(0,0,0,0.85));display:flex;flex-direction:column;gap:12px;align-items:stretch}
.fs-top{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.fs-left{display:flex;align-items:center;gap:12px;min-width:0}
.fs-cover{width:72px;height:72px;border-radius:10px;object-fit:cover;box-shadow:0 8px 36px rgba(0,0,0,.6);overflow:hidden}
.fs-title{font-weight:900;font-size:1.2rem;max-width:60vw;word-break:break-word}
.fs-time{font-weight:800;color:#fff}

/* controls row */
.fs-controls{display:flex;align-items:center;gap:10px;justify-content:flex-end}
.fs-controls button{width:52px;height:52px;border-radius:50%;border:0;background:transparent;color:#fff;font-size:20px;cursor:pointer;box-shadow:0 8px 30px rgba(0,0,0,.25)}
#fs-close{position:absolute;right:18px;top:12px;background:rgba(0,0,0,0.55);color:#fff;border:0;padding:8px 10px;border-radius:8px;font-weight:700;cursor:pointer;box-shadow:0 8px 24px rgba(0,0,0,.4)}
#fs-close:hover{background:#ff4d4d}

/* progress */
.progress-wrap{width:100%}
.progress-bar{width:100%;height:14px;background:rgba(255,255,255,0.12);border-radius:10px;overflow:hidden;cursor:pointer}
.progress-fill{height:100%;width:0;background:#40E0D0;border-radius:10px;transition:width .06s linear}

/* small screens */
@media (max-width:820px){
  .header img{width:180px;height:180px}
  .card img{height:200px}
  .fs-title{font-size:1rem}
  .mini-title{max-width:150px}
}

/* fade animation */
.fade-in{animation:fadeIn .35s ease both}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
</style>
</head>
<body>
<div class="container">
  <header class="header">
    <img src="Dua_Lipa.jpg" alt="Dua Lipa">
    <h1>Dua Lipa — Radical Optimism & Live from the Royal Albert Hall</h1>
    <p>
      Dua Lipa (nar. 22. srpna 1995) je britská zpěvačka, skladatelka a umělkyně kosovsko-albánského původu. 
      Níže najdeš kompletní fanpage k dvěma projektům z roku 2024 — studiovému albu <strong>Radical Optimism</strong> a živému záznamu 
      <strong>Live from the Royal Albert Hall</strong>. Stránka obsahuje kompletní tracklisty (mp3 a přidružená mp4 videa), mini-player a fullscreen video přehrávač s lištami barevně laděnými k albům.
    </p>
  </header>

  <!-- ALBUMS GRID -->
  <section class="albums-grid">
    <article class="card" onclick="openAlbum('radical')">
      <img src="radical_optimism.jpg" alt="Radical Optimism">
      <div class="card-body">
        <h3>Radical Optimism</h3>
        <p>Třetí studiové album Dua Lipy — vydáno 3. května 2024. Moderní retro-disco s mořskou symbolikou, texty o osobním růstu a sebevědomí.</p>
      </div>
    </article>

    <article class="card" onclick="openAlbum('live')">
      <img src="Live_from_the_Royal_Albert_Hall.jfif" alt="Live from the Royal Albert Hall">
      <div class="card-body">
        <h3>Live from the Royal Albert Hall</h3>
        <p>Živý záznam z 27. října 2024 — koncertní výkon s Heritage Orchestra. Autentická atmosféra a orchestrální aranže.</p>
      </div>
    </article>
  </section>

  <!-- RADICAL OPTIMISM PAGE -->
  <section id="page-radical" class="album-page">
    <button class="back" onclick="closeAlbum()">← Zpět</button>
    <div class="album-header">
      <img src="radical_optimism.jpg" alt="Radical Optimism">
      <div>
        <h2>Radical Optimism (2024)</h2>
        <div class="album-desc">
          <p>
            Radical Optimism je třetí studiové album Dua Lipy vydané 3. května 2024. Projekt navazuje na retro-disco atmosféru,
            ale přináší moderní nádech a svěží produkci. Album se dotýká témat osobního růstu, sebevědomí, ztrát i vítězství,
            vizuálně a symbolikou pak odkazuje k mořským motivům — klid, síla a vyrovnanost.
          </p>
          <p>
            (Níže je kompletní seznam skladeb — kliknutím na skladbu spustíš MP3 a zároveň se spustí doprovodné MP4 video ve fullscreen režimu.
            Video se bude smyčkovat, dokud audio neskončí.)
          </p>
        </div>
      </div>
    </div>

    <div id="tracklist-radical" class="tracklist"></div>
  </section>

  <!-- LIVE PAGE -->
  <section id="page-live" class="album-page">
    <button class="back" onclick="closeAlbum()">← Zpět</button>
    <div class="album-header">
      <img src="Live_from_the_Royal_Albert_Hall.jfif" alt="Live from the Royal Albert Hall">
      <div>
        <h2>Live from the Royal Albert Hall (2024)</h2>
        <div class="album-desc">
          <p>
            Živý záznam Dua Lipy nahraný 27. října 2024 s 53-členným orchestrem. Album přináší nové interpretace jejích skladeb a orchestrální aranže,
            které rozšiřují emocionální paletu vystoupení. Níže najdeš celý koncertní set — kliknutím spustíš audio + video.
          </p>
        </div>
      </div>
    </div>

    <div id="tracklist-live" class="tracklist"></div>
  </section>

  <!-- LONG BIOGRAPHY -->
  <section style="margin-top:20px;padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));">
    <h2 style="margin-bottom:12px">Životopis — Dua Lipa (dlouhá verze)</h2>
    <p style="color:#d7d7d7;line-height:1.65;margin-bottom:12px">
      Dua Lipa se narodila 22. srpna 1995 v Londýně do rodiny albanštiny mluvících rodičů z Kosova. V dětském věku vyrůstala mezi Londýnem a Kosovem,
      což formovalo její hudební vkus a kulturní identitu. Už jako teenagerka začala natáčet vlastní písně a vysílat cover verze na platformy, čímž si
      vybudovala počáteční fanouškovskou základnu. Její hlas, charisma a silný smysl pro vizuální identitu ji rychle přivedly k profesionální dráze.
    </p>
    <p style="color:#d7d7d7;line-height:1.65;margin-bottom:12px">
      Debutové album „Dua Lipa“ (2017) představilo její specifický přístup k popu — kombinaci chytlavých melodií, tanečních rytmů a asertivních textů.
      S hity jako „New Rules“ a „IDGAF“ získala mezinárodní pozornost a etablovala se jako hlas nové generace popových interpretů. Druhé album,
      „Future Nostalgia“ (2020), posunulo její zvuk dál — s retro-disco estetikou a moderním zpracováním, čímž upevnila své postavení popové ikony.
    </p>
    <p style="color:#d7d7d7;line-height:1.65;margin-bottom:12px">
      Kromě studiové tvorby je Dua Lipa známá i svými energetickými živými vystoupeními, pečlivými vizuálními koncepty a výraznými módními kolaboracemi.
      Její práce často reflektuje témata sebevědomí, nezávislosti a osobního růstu — texty, které oslovují široké publikum. V kariéře spolupracovala s řadou
      významných producentů a umělců, což se odrazilo v rozmanitosti žánrů a celebritních hostování.
    </p>
    <p style="color:#d7d7d7;line-height:1.65;margin-bottom:12px">
      V posledním období (2024) vydala dvě významná alba: studiové „Radical Optimism“ a živé „Live from the Royal Albert Hall“. Tyto projekty zachycují jak
      její další umělecký vývoj, tak i schopnost znovu interpretovat vlastní tvorbu v živém kontextu s plně orchestrální oporou. Její obraz a hudba
      pokračují v propojení taneční energie s osobní, introspektivní lyrikou.
    </p>
    <p style="color:#d7d7d7;line-height:1.65;margin-bottom:6px">
      Tento fanpage soubor kombinuje oba projekty do přehledné a funkční prezentace — kompletní tracklisty, mp3 i mp4 zdroje, mini-player a sofistikovaný
      fullscreen video player s kontrolami a barevným stylingem laděným k jednotlivým albům.
    </p>
  </section>

</div> <!-- /container -->

<!-- MINI PLAYER -->
<div id="mini-player" class="fade-in" aria-hidden="true">
  <div class="mini-left">
    <img id="mini-cover" class="mini-cover" src="radical_optimism.jpg" alt="cover">
    <div>
      <div id="mini-title" class="mini-title">—</div>
      <div id="mini-time" class="mini-time">0:00 / 0:00</div>
    </div>
  </div>
  <div class="mini-controls">
    <button id="mini-prev" title="Předchozí">⏮</button>
    <button id="mini-play" title="Přehrát / Pauza">▶</button>
    <button id="mini-next" title="Další">⏭</button>
    <button id="mini-expand" title="Otevřít video">⬆</button>
  </div>
</div>

<!-- FULLSCREEN PLAYER (shared for both albums) -->
<div id="fullscreen-player" aria-hidden="true">
  <div class="bg-video-wrap"><video id="fs-video" autoplay muted loop playsinline></video></div>

  <button id="fs-close" title="Zavřít video">✖</button>

  <div id="fs-controls-panel">
    <div class="fs-top">
      <div class="fs-left">
        <div style="width:72px;height:72px;overflow:hidden" class="fs-cover-wrap">
          <img id="fs-cover" class="fs-cover" src="radical_optimism.jpg" alt="cover">
        </div>
        <div class="fs-title" id="fs-title">—</div>
      </div>

      <div style="display:flex;align-items:center;gap:12px;flex-wrap:wrap;">
        <div id="fs-time" class="fs-time">0:00 / 0:00</div>
        <div class="fs-controls">
          <button id="fs-prev" title="Předchozí">⏮</button>
          <button id="fs-play" title="Přehrát / Pauza">▶</button>
          <button id="fs-next" title="Další">⏭</button>
        </div>
      </div>
    </div>

    <div class="progress-wrap">
      <div id="fs-progress" class="progress-bar" title="Kliknutím přejít">
        <div id="fs-progress-fill" class="progress-fill"></div>
      </div>
    </div>
  </div>
</div>

<script>
/* ---------- DATA: kompletní tracklisty (mp3 + mp4) ---------- */
const albumsData = {
  radical: [
    {num:1,title:"End Of An Era",mp3:"mech.mp3",mp4:"a82x20.mp4",duration:"3:15"},
    {num:2,title:"Houdini",mp3:"kouzelník.mp3",mp4:"a82xf4.mp4",duration:"3:08"},
    {num:3,title:"Training Season",mp3:"60m.mp3",mp4:"a82xvv.mp4",duration:"3:46"},
    {num:4,title:"These Walls",mp3:"zeď.mp3",mp4:"a82xxp.mp4",duration:"3:37"},
    {num:5,title:"Whatcha Doing",mp3:"Co.mp3",mp4:"a82ywb.mp4",duration:"3:17"},
    {num:6,title:"French Exit",mp3:"Francosisch.mp3",mp4:"a82yxv.mp4",duration:"3:21"},
    {num:7,title:"Illusion",mp3:"Iluze.mp3",mp4:"a82zdu.mp4",duration:"3:09"},
    {num:8,title:"Falling Forever",mp3:"Padat.mp3",mp4:"a82zjs.mp4",duration:"3:42"},
    {num:9,title:"Anything For Love",mp3:"Láska.mp3",mp4:"a82zlw.mp4",duration:"2:21"},
    {num:10,title:"Maria",mp3:"Marie.mp3",mp4:"a82zxw.mp4",duration:"3:07"},
    {num:11,title:"Happy For You",mp3:"Pro tebe.mp3",mp4:"a83003.mp4",duration:"4:04"}
  ],
  live: [
    {num:1,title:"Overture (Live from the Royal Albert Hall)",mp3:"uvod.mp3",mp4:"a892zo.mp4",duration:"1:47"},
    {num:2,title:"End Of An Era (Live from the Royal Albert Hall)",mp3:"era.mp3",mp4:"a8947k.mp4",duration:"4:00"},
    {num:3,title:"Houdini (Live from the Royal Albert Hall)",mp3:"kuzelnik.mp3",mp4:"a88wpd.mp4",duration:"3:37"},
    {num:4,title:"Training Season (Live from the Royal Albert Hall)",mp3:"100m.mp3",mp4:"a88y8r.mp4",duration:"3:41"},
    {num:5,title:"These Walls (Live from the Royal Albert Hall)",mp3:"zdi.mp3",mp4:"a89cke.mp4",duration:"3:51"},
    {num:6,title:"Whatcha Doing (Live from the Royal Albert Hall)",mp3:"what.mp3",mp4:"breakheart.mp4",duration:"3:59"},
    {num:7,title:"French Exit (Live from the Royal Albert Hall)",mp3:"francois.mp3",mp4:"dontstart.mp4",duration:"3:46"},
    {num:8,title:"Illusion (Live from the Royal Albert Hall)",mp3:"illuze.mp3",mp4:"a89isb.mp4",duration:"3:58"},
    {num:9,title:"Falling Forever (Live from the Royal Albert Hall)",mp3:"navždy.mp3",mp4:"idgaf.mp4",duration:"4:01"},
    {num:10,title:"Anything For Love (Live from the Royal Albert Hall)",mp3:"pro.mp3",mp4:"hotter.mp4",duration:"3:10"},
    {num:11,title:"Maria (Live from the Royal Albert Hall)",mp3:"babi.mp3",mp4:"a89ovs.mp4",duration:"3:46"},
    {num:12,title:"Happy For You (Live from the Royal Albert Hall)",mp3:"tebe.mp3",mp4:"blowyourmind.mp4",duration:"4:24"},
    {num:13,title:"Love Again (Live from the Royal Albert Hall)",mp3:"znovu.mp3",mp4:"a8d9nu.mp4",duration:"6:03"},
    {num:14,title:"Pretty Please (Live from the Royal Albert Hall)",mp3:"prosím.mp3",mp4:"blowyourmind.mp4",duration:"3:26"},
    {num:15,title:"Levitating (Live from the Royal Albert Hall)",mp3:"levitovat.mp3",mp4:"blowyourmind.mp4",duration:"4:25"},
    {num:16,title:"Sunshine (Live from the Royal Albert Hall)",mp3:"slunce.mp3",mp4:"blowyourmind.mp4",duration:"4:43"},
    {num:17,title:"Cold Heart (featuring: Elton John) (Live from the Royal Albert Hall)",mp3:"srdce.mp3",mp4:"blowyourmind.mp4",duration:"5:29"},
    {num:18,title:"Be The One (Live from the Royal Albert Hall)",mp3:"pravý.mp3",mp4:"pravý.mp4",duration:"4:50"},
    {num:19,title:"Dance The Night (Live from the Royal Albert Hall)",mp3:"barbie.mp3",mp4:"barbie.mp4",duration:"4:08"},
    {num:20,title:"Don’t Start Now (Live from the Royal Albert Hall)",mp3:"teď.mp3",mp4:"teď.mp4",duration:"4:26"}
  ]
};

/* ---------- RENDER TRACKLISTS ---------- */
function renderTracklist(albumKey, containerId){
  const container = document.getElementById(containerId);
  container.innerHTML = "";
  const list = albumsData[albumKey];
  list.forEach((t, idx) => {
    const div = document.createElement("div");
    div.className = "track fade-in";
    div.dataset.index = idx;
    div.innerHTML = `<div style="display:flex;align-items:center;gap:8px">
        <div class="num">${t.num}</div>
        <div class="title">${t.title}</div>
      </div>
      <div class="duration">${t.duration}</div>`;
    div.addEventListener("click", () => startPlayback(albumKey, idx));
    container.appendChild(div);
  });
}
renderTracklist('radical', 'tracklist-radical');
renderTracklist('live', 'tracklist-live');

/* ---------- AUDIO / VIDEO PLAYER LOGIKA (společná) ---------- */
let currentAlbumKey = null;
let currentIndex = 0;
const audio = new Audio();
audio.preload = "metadata";
const fsVideo = document.getElementById('fs-video');
const miniPlayer = document.getElementById('mini-player');
const miniTitle = document.getElementById('mini-title');
const miniCover = document.getElementById('mini-cover');
const miniTime = document.getElementById('mini-time');
const miniPlayBtn = document.getElementById('mini-play');
const miniPrevBtn = document.getElementById('mini-prev');
const miniNextBtn = document.getElementById('mini-next');
const miniExpandBtn = document.getElementById('mini-expand');

const fsPlayer = document.getElementById('fullscreen-player');
const fsCover = document.getElementById('fs-cover');
const fsTitle = document.getElementById('fs-title');
const fsTime = document.getElementById('fs-time');
const fsPlayBtn = document.getElementById('fs-play');
const fsPrevBtn = document.getElementById('fs-prev');
const fsNextBtn = document.getElementById('fs-next');
const fsCloseBtn = document.getElementById('fs-close');
const fsProgress = document.getElementById('fs-progress');
const fsProgressFill = document.getElementById('fs-progress-fill');

/* color mapping for album bars */
const albumColor = {
  radical: { accent: '#40E0D0', panel: 'linear-gradient(90deg, rgba(64,224,208,0.95), rgba(4,62,58,0.95))' },
  live: { accent: '#ff6b6b', panel: 'linear-gradient(90deg, rgba(255,107,107,0.95), rgba(30,10,10,0.95))' }
};

/* Start playback for an album + index */
function startPlayback(albumKey, index){
  const track = albumsData[albumKey][index];
  if(!track) return;
  currentAlbumKey = albumKey;
  currentIndex = index;

  // set audio
  audio.src = track.mp3;
  audio.play().catch(()=>{}); // may be blocked until user interacts

  // set video src and loop it until audio ends
  if(track.mp4){
    fsVideo.src = track.mp4;
    // play video in background (muted)
    fsVideo.currentTime = 0;
    fsVideo.play().catch(()=>{});
  } else {
    fsVideo.removeAttribute('src');
    fsVideo.load();
  }

  // show mini player and update displays
  miniPlayer.style.display = 'flex';
  miniTitle.textContent = track.title;
  miniCover.src = albumKey === 'radical' ? 'radical_optimism.jpg' : 'Live_from_the_Royal_Albert_Hall.jfif';
  updateTimeDisplays();

  // style mini player according to album
  stylePlayersForAlbum(albumKey);

  // update fullscreen info
  fsCover.src = miniCover.src;
  fsTitle.textContent = track.title;

  // ensure fullscreen overlay visible
  // we show fullscreen only when user clicks expand; autoplay doesn't force fullscreen.
}

/* style mini and fs controls by album */
function stylePlayersForAlbum(albumKey){
  const accent = albumColor[albumKey].accent;
  // mini player background gradient
  miniPlayer.style.background = `linear-gradient(90deg, ${accent}, rgba(10,10,10,0.3))`;
  // fs controls panel background
  const panel = document.getElementById('fs-controls-panel');
  panel.style.background = albumColor[albumKey].panel;
  // progress fill color
  fsProgressFill.style.background = accent;
  document.querySelector('.progress-fill')?.style && (document.querySelector('.progress-fill').style.background = accent);
}

/* playback controls */
miniPlayBtn.addEventListener('click', togglePlay);
fsPlayBtn.addEventListener('click', togglePlay);
miniPrevBtn.addEventListener('click', playPrev);
miniNextBtn.addEventListener('click', playNext);
fsPrevBtn.addEventListener('click', playPrev);
fsNextBtn.addEventListener('click', playNext);

miniExpandBtn.addEventListener('click', ()=>{ openFullscreen(); });
document.getElementById('fs-close').addEventListener('click', ()=>{ closeFullscreen(); });

function togglePlay(){
  if(audio.paused) {
    audio.play().catch(()=>{});
    fsVideo.play().catch(()=>{});
  } else {
    audio.pause();
    try { fsVideo.pause(); } catch(e){}
  }
  updatePlayButtons();
}

function updatePlayButtons(){
  miniPlayBtn.textContent = audio.paused ? '▶' : '⏸';
  fsPlayBtn.textContent = audio.paused ? '▶' : '⏸';
}

/* next / prev logic */
function playNext(){
  if(!currentAlbumKey) return;
  const list = albumsData[currentAlbumKey];
  currentIndex = (currentIndex + 1) % list.length;
  startPlayback(currentAlbumKey, currentIndex);
}
function playPrev(){
  if(!currentAlbumKey) return;
  const list = albumsData[currentAlbumKey];
  currentIndex = (currentIndex - 1 + list.length) % list.length;
  startPlayback(currentAlbumKey, currentIndex);
}

/* audio time updates -> progress & displays */
audio.addEventListener('timeupdate', ()=> {
  updateTimeDisplays();
});
audio.addEventListener('loadedmetadata', ()=> {
  updateTimeDisplays();
});
audio.addEventListener('ended', ()=> {
  // when audio ends, automatically go to next track
  playNext();
});

/* update time displays both mini and fullscreen */
function formatTime(t){
  if(!t || isNaN(t) || !isFinite(t)) return '0:00';
  const m = Math.floor(t/60);
  const s = Math.floor(t%60);
  return `${m}:${s<10? '0'+s : s}`;
}
function updateTimeDisplays(){
  const c = audio.currentTime || 0;
  const d = audio.duration || 0;
  const txt = `${formatTime(c)} / ${formatTime(d)}`;
  miniTime.textContent = txt;
  fsTime.textContent = txt;
  // progress fill
  const pct = d ? (c/d)*100 : 0;
  fsProgressFill.style.width = `${pct}%`;
}

/* progress bar seeking */
fsProgress.addEventListener('click', (e)=>{
  const rect = fsProgress.getBoundingClientRect();
  const pct = (e.clientX - rect.left) / rect.width;
  if(audio.duration) audio.currentTime = pct * audio.duration;
});

/* open / close fullscreen */
function openFullscreen(){
  if(!currentAlbumKey) return;
  fsPlayer.style.display = 'flex';
  fsPlayer.setAttribute('aria-hidden','false');
  // ensure video plays and is visible
  try { fsVideo.play().catch(()=>{}); } catch(e){}
}
function closeFullscreen(){
  // hide overlay, pause video (but do not stop audio)
  fsPlayer.style.display = 'none';
  fsPlayer.setAttribute('aria-hidden','true');
  try { fsVideo.pause(); } catch(e){}
}

/* keep play buttons in sync with audio & video */
audio.addEventListener('play', ()=> {
  updatePlayButtons();
  try { fsVideo.play().catch(()=>{}); } catch(e){}
});
audio.addEventListener('pause', ()=> {
  updatePlayButtons();
  try { fsVideo.pause(); } catch(e){}
});

/* ---------- PAGE NAVIGATION (albums) ---------- */
function openAlbum(id){
  document.querySelectorAll('.album-page').forEach(p=>p.classList.remove('active'));
  document.getElementById('page-'+id).classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
}
function closeAlbum(){
  document.querySelectorAll('.album-page').forEach(p=>p.classList.remove('active'));
  window.scrollTo({top:0,behavior:'smooth'});
}

/* ---------- INITIAL STATE: nothing playing until user clicks ---------- */

/* disable right-click / copy like v tvém kódu (volitelné) */
document.addEventListener('contextmenu', event => event.preventDefault());
document.addEventListener('copy', event => event.preventDefault());

/* Accessibility: keyboard shortcuts */
document.addEventListener('keydown', (e)=>{
  if(e.code === 'Space'){ e.preventDefault(); togglePlay(); }
  if(e.key === 'ArrowRight'){ playNext(); }
  if(e.key === 'ArrowLeft'){ playPrev(); }
});

</script>
</body>
</html>
